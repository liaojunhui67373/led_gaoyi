<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>开关</title>
  <script src="../static/vue/vue.js"></script>
  <script src="../static/axios/axios.min.js"></script>
  <script src="../static/jquery/jquery-3.5.1.min.js"></script>
</head>

<body>




  <!--全开-->
  <p><input type="button" value="开启所有" style="width: 100px; height: 50px" id="openAllBtn" onclick="openAllLed()"></p>
  <!--全关-->
  <p><input type="button" value="关闭所有" style="width: 100px; height: 50px" id="closeAllBtn" onclick="closeAllLed()"></p>

  <style>
    div {
      float: left;
    }
  </style>
  <!--按键-->
  <div>
    <div id="34425">
      <p>设备 1</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn34425"
          onclick="openLed('32425')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn34425"
          onclick="closeLed('32425')"></p>
    </div>
    <div>
      <p>设备 2</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn34422"
          onclick="openLed('32422')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn34422"
          onclick="closeLed('32422')"></p>
    </div>
    <div>
      <p>设备 3</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32411"
          onclick="openLed('32411')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32411"
          onclick="closeLed('32411')"></p>
    </div>
    <div>
      <p>设备 4</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32426"
          onclick="openLed('32426')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32426"
          onclick="closeLed('32426')"></p>
    </div>
    <div>
      <p>设备 5</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32428"
          onclick="openLed('32428')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32428"
          onclick="closeLed('32428')"></p>
    </div>
    <div>
      <p>设备 6</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32429"
          onclick="openLed('32429')">
      </p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32429"
          onclick="closeLed('32429')"></p>
    </div>
    <div>
      <p>设备 7</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32430"
          onclick="openLed('32430')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32430"
          onclick="closeLed('32430')"></p>
    </div>
    <div>
      <p>设备 8</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32431"
          onclick="openLed('32431')">
      </p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32431"
          onclick="closeLed('32431')"></p>
    </div>
    <div>
      <p>设备 9</p>
      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32432"
          onclick="openLed('32432')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32432"
          onclick="closeLed('32432')"></p>
    </div>
    <div>
      <p>设备 10</p>

      <p><input type="button" value="开灯" style="width: 100px; height: 50px" id="openBtn32433"
          onclick="openLed('32433')"></p>
      <p><input type="button" value="关灯" style="width: 100px; height: 50px" id="closeBtn32433"
          onclick="closeLed('32433')"></p>
    </div>
  </div>

  <!--添加设备-->
  <div style="margin-top: 200px;margin-left: -1000px;  float: left;">添加设备 <input type="text" id="devName"
      placeholder="请输入设备名称"><span><input type="button" value="确认" id="addDev" onclick="addDev()"></span></div>

  <!--显示所有设备-->
  <div style="margin-top: 250px; margin-left: -1000px; float: left;" class="ledName">
      已绑定设备:
      <ul>
        <li v-for="device in dev.devlist">dev_id:{{device.dev_id}} --- dev_name:{{device.dev_name}} <span><input type="button" value="修改名称" id=device.dev_id onclick="updateName()"></span></li>
      </ul>
  </div>

  <div>
    <img src="../static/image/0d1102636fdf36cdff2f9fefbfc5393.jpg" style="margin-top: 270px; margin-left: -300px; float: left;">
  </div>

  <script>

    //显示所有已绑定的设备
    window.onload = function(){
      $.ajax({
        url:"/showAllDev",
        type:"get",
        data:"json",
        success:function(data){
          var dev = JSON.parse(data);
          console.log(dev);
          var showVue = new Vue({
            el:'.ledName',
            data:{
              dev
            }
          })
        }
      })
    }

    //修改设备名称

    //发送开灯请求
    function openLed(string) {
      var oReq = new XMLHttpRequest();
      oReq.open('GET', '/openLed?id=' + string);
      oReq.send(null);
    };

    //发送关灯请求
    function closeLed(string) {
      var oReq = new XMLHttpRequest();
      oReq.open('GET', '/closeLed?id=' + string);
      oReq.send(null);
    }

    //开启所有灯
    function openAllLed() {
      var oReq = new XMLHttpRequest();
      oReq.open('GET', '/allON');
      oReq.send(null);
    }

    //关闭所有灯
    function closeAllLed() {
      var oReq = new XMLHttpRequest();
      oReq.open('GET', '/allOFF');
      oReq.send(null);
    }

    //添加设备
    function addDev() {
      $.ajax({
        url: '/addDev?devName=' + $("#devName").val(),
        type: "get",
        data: "json",
        success: function (data) {

          if (data == 'success') {
            $("#devName").val("");
            alert('添加成功');

          } else {
            alert('没有找到要添加的设备')
          }
        }
      })
    }


  </script>
</body>

</html>